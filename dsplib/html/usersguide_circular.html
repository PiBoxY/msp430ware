<!-- --COPYRIGHT--,BSD
 *  Copyright (c) 2017, Texas Instruments Incorporated
 *  All rights reserved.
 * 
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 * 
 *  *  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 * 
 *  *  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 * 
 *  *  Neither the name of Texas Instruments Incorporated nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 * 
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 *  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 *  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 *  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 *  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 *  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * --/COPYRIGHT-- -->
<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>MSP DSP Library: FIR Circular Buffer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <img alt="Logo" width=25% src="ti_hz_2c_pos_rgb_png.png"/>
    <table cellspacing="0" cellpadding="0">
        <tbody>
        <tr style="height: 56px;">
            <td style="padding-left: 0.5em;">
                <div id="projectname">MSP DSP Library
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="usersguide.html"><span>Users&#160;Guide</span></a></li>
      <li><a href="gui.html"><span>Filter&#160;Design&#160;GUI</span></a></li>
      <li><a href="modules.html"><span>API&#160;Guide</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li><a href="disclaimer.html"><span>Disclaimer</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('usersguide_circular.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">FIR Circular Buffer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The FIR functions in DSPLib require past sample history to compute output samples. The most straight forward approach is to copy a block of samples from the end of the previous sample buffer to the beginning of the next sample buffer but is generally inefficient and requires additional time and energy. The FIR functions include a circular input buffer feature where the end of the input buffer wraps around to the beginning of the same buffer. This feature is supported by LEA and enables FIR filtering with less memory usage and less sample copy overhead.</p>
<p>When using the circular buffer feature the input buffer must be twice the FIR length and aligned to an address equal to it's total byte size. The diagram below shows an example allocation of a 128 sample circular buffer aligned to a 256-byte address and separated into two 64-sample buffers for FIR filtering.</p>
<div class="image">
<img src="circular_buffer.svg" alt="circular_buffer.svg"/>
<div class="caption">
Example circular buffer alignment for 64-sample Q15 FIR filter</div></div>
<p> The code snippet below from example <a href="filter_ex1_fir_q15_8c-example.html">filter_ex1_fir_q15</a> demonstrates how to allocate the above buffer with the correct alignment using the included macros.</p>
<div class="fragment"><div class="line"><span class="comment">/* Filter parameters */</span></div>
<div class="line"><span class="preprocessor">#define FIR_LENGTH      64</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Circular buffer of size 2*FIR_LENGTH, aligned to 4*FIR_LENGTH in order to</span></div>
<div class="line"><span class="comment"> * use the circular buffer feature.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a class="code" href="group__dsplib__support__device.html#gaf460d7131b31e903312225405ba4937e">DSPLIB_DATA</a>(circularBuffer,<a class="code" href="group__dsplib__filter__real__fir.html#ga967feb5ab793585e1322d8befd9933d0">MSP_ALIGN_FIR_Q15</a>(FIR_LENGTH))</div>
<div class="line"><a class="code" href="group__dsplib__types.html#ga88f4415c9bbbaa6cb0dfbafb91b520ca">_q15</a> circularBuffer[2*FIR_LENGTH];</div>
</div><!-- fragment --><p>The following steps demonstrate how to use the same 128-sample circular buffer to run a continuous FIR filter with 64 samples and 4 coefficient taps.</p>
<div class="image">
<img src="circular_buffer_usage.svg" alt="circular_buffer_usage.svg"/>
<div class="caption">
Example circular buffer usage with 64 sample Q15 FIR and tap size of 4</div></div>
<ul>
<li>Step 1: Zero initialize the entire circular buffer.</li>
<li>Step 2: Fill Buffer 1 with the first 64 samples (x[0] through x[63]) and invoke the FIR function with source pointing to the end of Buffer 2 minus the coefficient length (4 in this example).</li>
<li>Step 3: Fill Buffer 2 with the next 64 samples (x[64] through x[127]) and invoke the FIR function with source pointing to the end of Buffer 1 minus the coefficient length.</li>
<li>Step 4: Fill Buffer 1 with the next 64 samples (x[128] through x[191]) and invoke the FIR function with source pointing to the end of Buffer 2 minus the coefficient length.</li>
<li>Alternate steps 3 and 4 for each new 64 samples.</li>
</ul>
<p>See examples <a href="filter_ex1_fir_q15_8c-example.html">filter_ex1_fir_q15</a> and <a href="filter_ex2_fir_iq31_8c-example.html">filter_ex2_fir_iq31</a> for example code using the circular buffer feature with Q15 and IQ31 FIR filters. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
	<p>Copyright &#169; 2015, Texas Instruments Incorporated</p>	
    </li>
  </ul>
</div>
</body>
</html>
