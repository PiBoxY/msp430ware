<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>MSP430UltrasonicLibrary: Change Log</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link id="favicon" rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="tiapistylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MSP430UltrasonicLibrary
   &#160;<span id="projectnumber">02_20_00_16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Change Log </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This chapter describes the difference between the Ultrasonic Sensing Library. The latest (most-current) builds are shown first.</p>
<h2>What's New</h2>
<p><b>02_20_00_16</b></p>
<ul>
<li>Library<ul>
<li>Enhancements:<ul>
<li>Library User's Guide documentation update for Memory footprint comparison between optimized libraries.</li>
</ul>
</li>
<li>Bug Fix:<ul>
<li>None</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Revision History</h2>
<p><b>02_20_00_15</b></p>
<ul>
<li>Library<ul>
<li>Enhancements:<ul>
<li>Added support for capture and algorithm channel swapping</li>
<li>Removed ADC Capture DC offset inside USS_calibrateSignalGain API</li>
<li>Added new calibration API USS_calculateOffsets. Please refer to FR6043_USSSWLib_template_example or FR6047_USSSWLib_template_example for recommended use of API.</li>
<li>Added meter calibration feature for volume flor rate computation</li>
<li>Increased monitoring loop accuracy and power optimized USS_verifyHSPLLFrequency API. For more information refer to "HSPLL Frequency Verification Test Configuration" section in the <a href="../../lib_users_guide.html">Library User's Guide</a></li>
<li>Enhanced absTOF_lobe to use look-up table (LUT) for more accurate parabolic interpolation<ul>
<li>Look-up table must be precomputed and have length that is a power of two.</li>
<li>It is recommended to generate Look-up table using USS Design Center tool as an alternative the Matlab code to generate the values is provided in the <a href="../../lib_users_guide.html">Library User's Guide</a>.</li>
<li>New algorithm configuration parameters:<ul>
<li>pInterpCorrectionTablePtr: pointer to LUT. Setting to NULL will disable using the table.</li>
<li>interpCorrectionTableLenght: length of LUT, must be a power of two. If offsetCorrectionTablePtr is set to NULL this parameter does not matter.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Renamed USS_Alg_dToF_Calculation_Option.USS_Alg_dToF_Calculation_Option_gas to USS_Alg_dToF_Calculation_Option.USS_Alg_dToF_Calculation_Option_estimate.<ul>
<li>A shadow definition for USS_Alg_dToF_Calculation_Option_gas was included for backwards compatibility. This shadow defintion might be removed in future releases.</li>
<li>USS_Alg_dToF_Calculation_Option_estimate (previously named USS_Alg_dToF_Calculation_Option_gas) method, this method is now recommended for water and gas flow applications.<ul>
<li>Added support for windowing when using USS_Alg_dToF_Calculation_Option_estimate.</li>
<li>New algorithm configuration parameter:<ul>
<li>maxSampleShift: Parameter specifying maximum shift in samples for deltaTOF calculation, e.g. setting of 8 with 4 samples per cycle supports high flow +/- 2 cycles.</li>
<li>shiftRangeError: Error flag when absTOF difference is outside maxSampleShift, error flag set true and absTOF result unchanged.</li>
<li>USS_Alg_dToF_Calculation_Option_water method is still available but is deprecated and should not be used for high flow water.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Bug fix<ul>
<li>Fix clock correction propagation to water delta time of flight calculation.</li>
<li>Fix generation of stop pulses</li>
</ul>
</li>
<li>Deprecated:<ul>
<li>USS_highFlow_option.USS_highFlow_option_version1 and USS_highFlow_option.USS_highFlow_option_version2 please refer to <a href="../../lib_users_guide.html">User's Guide</a> for more information regarding recommended DToF computation option for high water volume flow rate applications.</li>
</ul>
</li>
</ul>
</li>
<li>Example project<ul>
<li>Bug Fix<ul>
<li>Fixed incorrect memory allocation of gUSSLEARAMReservedBlock2 which could corrupt memory when USS_SW_LIB_APP_MAX_FILTER_LENGTH was set 0 and USS_Alg_AbsToF_Calculation_Option_hilbert or USS_Alg_AbsToF_Calculation_Option_hilbertwide were selected.</li>
</ul>
</li>
<li>Enhancement<ul>
<li>Updated example project to support wide absolute time of flight computation options with MSP430FR6047 device variants</li>
<li>Added support for AbstoF LUT enhancements</li>
<li>Added example project for MSP430FR6043 device</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><b>02_10_00_07</b></p>
<ul>
<li>Fix device hang-up when running algorithms</li>
<li>Split library into:<ul>
<li>Algorithm code (provided in .lib format)</li>
<li>Firing/Capture. Calibration, Application Debug code (provided in source code)</li>
</ul>
</li>
<li>Merged Water and Gas libraries</li>
<li>Added capability to control external circuitry</li>
<li>Added APIâ€™s to generate reference binary patterns</li>
<li>Added Abs TOF computation option:<ul>
<li>Water computation options<ul>
<li>Lobe tracking</li>
<li>Hilbert</li>
</ul>
</li>
<li>Gas computation options<ul>
<li>Lobe wide</li>
<li>Hilbert wide</li>
</ul>
</li>
</ul>
</li>
<li>[Enhancement] Add placeholder for AFE using 5V and future options</li>
<li>[Enhancement] Added memory optimized library for water applications</li>
<li>[Library Update] Removed RTC timer trigger and external trigger options from library</li>
<li>[Fix] Default configuration of template example has been updated to 16 MHz</li>
<li>[Fix] Library is masking specific error code with generic error code in USS_commonTriggerSingleCapture API</li>
<li>[Fix] Multi-tone configuration.- Incorrect multitone configuration for f1 200 and f2 280 and 30 pulses</li>
<li>[Fix] Multi-tone configuration.- DMA interrupt using GPIO unnecessarily</li>
<li>[Fix] External amplifier gain line is high all the time</li>
<li>[Fix] Library example configuration files are using incorrect macro LEA memory allocation macros</li>
</ul>
<h3>**IMPORTANT Library updates:**</h3>
<p>Please refer to the library <a href="../../lib_users_guide.html">User's Guide</a> for more details regarding Library architecture updates.</p>
<h4>API updates</h4>
<ul>
<li>USS_getUPSPtr(void) updated to <a class="el" href="group__applicationdebug__api.html#ga1856f8634c061518c46975b1e1d568b1" title="The following API allows to obtain the address were UPS capture starts. IMPORTANT: USS_configureUltra...">USS_getUPSPtr(USS_SW_Library_configuration *config)</a></li>
<li>USS_getDNSPtr(void) updated to <a class="el" href="group__applicationdebug__api.html#gaae3020d746b28850604a503d029644ca" title="The following API allows to obtain the address were DNS capture starts. IMPORTANT: USS_configureUltra...">USS_getDNSPtr(USS_SW_Library_configuration *config)</a></li>
</ul>
<h4>API removed:</h4>
<ul>
<li>USS_setUPSPtr</li>
<li>USS_setDNSPtr</li>
</ul>
<h4>Library configuration updates</h4>
<ul>
<li>Updated USS_Measurement_Configuration configuration structure.<ul>
<li>The following structure member have been modified or replaced<ul>
<li>USS_measurement_pause_state<ul>
<li>Now defined as part of USS_Pulse_Configuration struct</li>
</ul>
</li>
<li>USS_measurement_pulse_polarity<ul>
<li>Now defined as part of USS_Pulse_Configuration struct</li>
</ul>
</li>
<li>pulseLowPhasePeriod<ul>
<li>Replaced by <a class="el" href="struct___u_s_s___pulse___single___dual___tone___configuration__.html#a33435ebe91ccff60d49c5ef41fa4bb4e">USS_Pulse_Single_Dual_Tone_Configuration.F1DutyCycle</a></li>
</ul>
</li>
<li>pulseHighPhasePeriod<ul>
<li>Replaced by <a class="el" href="struct___u_s_s___pulse___single___dual___tone___configuration__.html#a33435ebe91ccff60d49c5ef41fa4bb4e">USS_Pulse_Single_Dual_Tone_Configuration.F1DutyCycle</a></li>
</ul>
</li>
<li>numOfExcitationPulses<ul>
<li>Replaced by <a class="el" href="struct___u_s_s___pulse___single___dual___tone___configuration__.html#a9e80c4cbe38bdbc12bade33900f08979">USS_Pulse_Single_Dual_Tone_Configuration.numOfF1Cycles</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Updated USS_HSPLL_Configuration configuration structure:<ul>
<li>USS HSPLL input clock freq is now defined via USS_HSPLL_input_clock_freq ussXtalFreq parameter.</li>
</ul>
</li>
<li>Updated USS_Algorithms_User_Configuration configuration structure:<ul>
<li>New calculation options configured via the following structure members:<ul>
<li>USS_Alg_AbsToF_Calculation_Option</li>
<li>USS_Alg_dToF_Calculation_Option</li>
<li>USS_Alg_volume_flow_Calculation_Option</li>
</ul>
</li>
<li>pWinCoef renamed to pLEAMemBuffer1</li>
<li>pNvMemBuffer datatype changed from int16_t to int32_t</li>
</ul>
</li>
<li>Interrupt function callbacks now declared in <code>ussSWLib/USS_HAL/USS_Lib_HAL.h</code></li>
<li>Renamed USS_SAPH_TM4_TM_OUT_INTERRUPT macro to USS_SAPH_TMF_TM_OUT_INTERRUPT</li>
<li>Removed USS_measurement_prescaler structure</li>
</ul>
<p><b>01_40_00_06</b></p>
<ul>
<li>USS SW Library:<ul>
<li>Bug Fix:<ul>
<li>Removed PPG frequency prescaler feature.</li>
</ul>
</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>None</li>
</ul>
</li>
</ul>
<p><b>01_40_00_05</b> â€‹</p>
<ul>
<li>USS SW Library<ul>
<li>Bug Fix:<ul>
<li>Fixed bug when loading bandpass coefficients. Coefficient[0] wasn't getting load to LEA RAM memory correctly.</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Documentation update.</li>
</ul>
</li>
</ul>
</li>
<li>USS GUI demo project has been removed from the library examples project directory</li>
</ul>
<p><b>01_40_00_04</b></p>
<ul>
<li>USS SW Library<ul>
<li>Bug Fix:<ul>
<li>Fix DC Offset estimation routine</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Added check to confirm user does not select TM_C other than zero if ULPBiasDelay is used.</li>
<li>Removed USS_calibrateIDAC API fron the library.</li>
<li>Added extra configuration parameter to USS_estimateDCoffset to allow user to specify if a new capture is required as part of calibration.</li>
<li>Added library version definition as part as library build.</li>
</ul>
</li>
</ul>
</li>
<li>USS GUI demo project<ul>
<li>Bug Fix:<ul>
<li>Fix USS Design Center communication bug when sending ADC capture sizes multiples of 27</li>
<li>Fix build error when disabling LCD</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Updated project to use new version of USS_estimateDCoffset API and use recommended capture mode based on project configuration.</li>
<li>Move timer used by USS from TA4 to TA2</li>
<li>Stop timer used by Design Center Comm when not used</li>
<li>Disable ADC when not used</li>
<li>Change range of transducer frequency to &gt;2Mhz</li>
<li>Change high/Low PPG periods to get closer to desired frequency.</li>
<li>Enable/disable SVSH (enabled by default)</li>
<li>Add periodic DC Offset estimation</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><b>01_40_00_03</b></p>
<ul>
<li>USS SW Library<ul>
<li>Bug Fix:<ul>
<li>Fix incorrect reconfiguration of USS submodule module after calling USS_calibrateIDAC</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Used recommended USS module configuration during ULP bias mode</li>
</ul>
</li>
</ul>
</li>
<li>USS GUI demo project<ul>
<li>Bug Fix:<ul>
<li>Add initalization of restartLowPowerCaptureCount congifuration parameter</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Updated USS_DIAGNOSTIC_MODE Library configuration from USS_diagnostics_mode_2 to USS_diagnostics_mode_0</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><b>01_40_00_02</b></p>
<ul>
<li>USS SW Library<ul>
<li>Bug Fix:<ul>
<li>Fix USS_verifyHSPLLFrequency were API could get stuck if a HSPLL unlick event occurred during the test.</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Documentation Updates</li>
</ul>
</li>
</ul>
</li>
<li>USS GUI demo project<ul>
<li>Bug Fix:<ul>
<li>Removed unnecessary USS_DTC_START_ADDRESS macro from library configuration in all example projects.</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>ULP bias configuration can be controlled using Param2 from USS Design Center</li>
<li>Updated application to reset USS module when a PLL unlock event is detected</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><b>01_40_00_01</b></p>
<ul>
<li>USS SW Library<ul>
<li>Bug Fix:<ul>
<li>None</li>
</ul>
</li>
<li>Enhancements:<ul>
<li>Added support for MSP430FR604x Rev B silicon</li>
<li>Added three parameter to USS_Measurement_Configuration structure â€‹ * USS_measurement_ULP_bias_delay â€‹ * USS_measurement_bias_impedance â€‹ * USS_measurement_mux_charge_pump</li>
<li>Added new support for new API "USS\_resetUSSModule". New API allow user to enable/disable reconfiguration of USS module as part of API functionality.</li>
<li>If Rev B silicon functionality is attempted to be excercised in Rev A silicon the library will return the following error code "USS\_meesage\_code\_silicon\_version\_does\_not\_support\_this\_functionality"</li>
<li>This version of the library is backwards compatible with Rev A. When running on Rev A silicon the new library parameter are ignored. </li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><small>
  <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2019</a>, Texas Instruments Incorporated. All rights reserved. <br>
  <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>
</small>
</body>
</html>
